/bin/sh: 1: cannot open vmlinux.h: No such file
[*] Generating vmlinux.h from running kernel BTF...
bpftool btf dump file /sys/kernel/btf/vmlinux format c > vmlinux.h
[+] vmlinux.h ready ( lines)
[*] Compiling vm BPF program...
clang -g -O2 -target bpf -D__TARGET_ARCH_arm64 -I/usr/include/aarch64-linux-gnu -I. -c vm_tracer.bpf.c -o vm_tracer.bpf.o
vm_tracer.bpf.c:378:52: error: no member named 'mmap' in 'struct mm_struct'
  378 |     struct vm_area_struct *vma = BPF_CORE_READ(mm, mmap);
      |                                  ~~~~~~~~~~~~~~~~~~^~~~~
/usr/include/bpf/bpf_core_read.h:443:17: note: expanded from macro 'BPF_CORE_READ'
  443 |         ___type((src), a, ##__VA_ARGS__) __r;                               \
      |         ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:314:38: note: expanded from macro '___type'
  314 | #define ___type(...) typeof(___arrow(__VA_ARGS__))
      |                             ~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:312:64: note: expanded from macro '___arrow'
  312 | #define ___arrow(...) ___apply(___arrow, ___narg(__VA_ARGS__))(__VA_ARGS__)
      |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:303:28: note: expanded from macro '___arrow2'
  303 | #define ___arrow2(a, b) a->b
      |                         ~  ^
vm_tracer.bpf.c:378:52: error: no member named 'mmap' in 'struct mm_struct'
  378 |     struct vm_area_struct *vma = BPF_CORE_READ(mm, mmap);
      |                                  ~~~~~~~~~~~~~~~~~~^~~~~
/usr/include/bpf/bpf_core_read.h:444:34: note: expanded from macro 'BPF_CORE_READ'
  444 |         BPF_CORE_READ_INTO(&__r, (src), a, ##__VA_ARGS__);                  \
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:352:20: note: expanded from macro 'BPF_CORE_READ_INTO'
  351 |         ___core_read(bpf_core_read, bpf_core_read,                          \
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  352 |                      dst, (src), a, ##__VA_ARGS__)                          \
      |                      ~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:343:18: note: expanded from macro '___core_read'
  342 |         ___apply(___core_read, ___empty(__VA_ARGS__))(fn, fn_ptr, dst,      \
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  343 |                                                       src, a, ##__VA_ARGS__)
      |                                                       ~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:336:38: note: expanded from macro '___core_read0'
  336 |         ___read(fn, dst, ___type(src), src, a);
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~
/usr/include/bpf/bpf_core_read.h:317:61: note: expanded from macro '___read'
  317 |         read_fn((void *)(dst), sizeof(*(dst)), &((src_type)(src))->accessor)
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
/usr/include/bpf/bpf_core_read.h:246:79: note: expanded from macro 'bpf_core_read'
  246 |         bpf_probe_read_kernel(dst, sz, (const void *)__builtin_preserve_access_index(src))
      |                                                                                      ^~~
vm_tracer.bpf.c:393:34: error: no member named 'vm_next' in 'struct vm_area_struct'
  393 |         vma = BPF_CORE_READ(vma, vm_next);
      |               ~~~~~~~~~~~~~~~~~~~^~~~~~~~
/usr/include/bpf/bpf_core_read.h:443:17: note: expanded from macro 'BPF_CORE_READ'
  443 |         ___type((src), a, ##__VA_ARGS__) __r;                               \
      |         ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:314:38: note: expanded from macro '___type'
  314 | #define ___type(...) typeof(___arrow(__VA_ARGS__))
      |                             ~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:312:64: note: expanded from macro '___arrow'
  312 | #define ___arrow(...) ___apply(___arrow, ___narg(__VA_ARGS__))(__VA_ARGS__)
      |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:303:28: note: expanded from macro '___arrow2'
  303 | #define ___arrow2(a, b) a->b
      |                         ~  ^
vm_tracer.bpf.c:428:52: error: no member named 'mmap' in 'struct mm_struct'
  428 |     struct vm_area_struct *vma = BPF_CORE_READ(mm, mmap);
      |                                  ~~~~~~~~~~~~~~~~~~^~~~~
/usr/include/bpf/bpf_core_read.h:443:17: note: expanded from macro 'BPF_CORE_READ'
  443 |         ___type((src), a, ##__VA_ARGS__) __r;                               \
      |         ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:314:38: note: expanded from macro '___type'
  314 | #define ___type(...) typeof(___arrow(__VA_ARGS__))
      |                             ~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:312:64: note: expanded from macro '___arrow'
  312 | #define ___arrow(...) ___apply(___arrow, ___narg(__VA_ARGS__))(__VA_ARGS__)
      |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:303:28: note: expanded from macro '___arrow2'
  303 | #define ___arrow2(a, b) a->b
      |                         ~  ^
vm_tracer.bpf.c:428:52: error: no member named 'mmap' in 'struct mm_struct'
  428 |     struct vm_area_struct *vma = BPF_CORE_READ(mm, mmap);
      |                                  ~~~~~~~~~~~~~~~~~~^~~~~
/usr/include/bpf/bpf_core_read.h:444:34: note: expanded from macro 'BPF_CORE_READ'
  444 |         BPF_CORE_READ_INTO(&__r, (src), a, ##__VA_ARGS__);                  \
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:352:20: note: expanded from macro 'BPF_CORE_READ_INTO'
  351 |         ___core_read(bpf_core_read, bpf_core_read,                          \
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  352 |                      dst, (src), a, ##__VA_ARGS__)                          \
      |                      ~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:343:18: note: expanded from macro '___core_read'
  342 |         ___apply(___core_read, ___empty(__VA_ARGS__))(fn, fn_ptr, dst,      \
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  343 |                                                       src, a, ##__VA_ARGS__)
      |                                                       ~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:336:38: note: expanded from macro '___core_read0'
  336 |         ___read(fn, dst, ___type(src), src, a);
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~
/usr/include/bpf/bpf_core_read.h:317:61: note: expanded from macro '___read'
  317 |         read_fn((void *)(dst), sizeof(*(dst)), &((src_type)(src))->accessor)
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
/usr/include/bpf/bpf_core_read.h:246:79: note: expanded from macro 'bpf_core_read'
  246 |         bpf_probe_read_kernel(dst, sz, (const void *)__builtin_preserve_access_index(src))
      |                                                                                      ^~~
vm_tracer.bpf.c:437:34: error: no member named 'vm_next' in 'struct vm_area_struct'
  437 |         vma = BPF_CORE_READ(vma, vm_next);
      |               ~~~~~~~~~~~~~~~~~~~^~~~~~~~
/usr/include/bpf/bpf_core_read.h:443:17: note: expanded from macro 'BPF_CORE_READ'
  443 |         ___type((src), a, ##__VA_ARGS__) __r;                               \
      |         ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:314:38: note: expanded from macro '___type'
  314 | #define ___type(...) typeof(___arrow(__VA_ARGS__))
      |                             ~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:312:64: note: expanded from macro '___arrow'
  312 | #define ___arrow(...) ___apply(___arrow, ___narg(__VA_ARGS__))(__VA_ARGS__)
      |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:303:28: note: expanded from macro '___arrow2'
  303 | #define ___arrow2(a, b) a->b
      |                         ~  ^
vm_tracer.bpf.c:471:52: error: no member named 'mmap' in 'struct mm_struct'
  471 |     struct vm_area_struct *vma = BPF_CORE_READ(mm, mmap);
      |                                  ~~~~~~~~~~~~~~~~~~^~~~~
/usr/include/bpf/bpf_core_read.h:443:17: note: expanded from macro 'BPF_CORE_READ'
  443 |         ___type((src), a, ##__VA_ARGS__) __r;                               \
      |         ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:314:38: note: expanded from macro '___type'
  314 | #define ___type(...) typeof(___arrow(__VA_ARGS__))
      |                             ~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:312:64: note: expanded from macro '___arrow'
  312 | #define ___arrow(...) ___apply(___arrow, ___narg(__VA_ARGS__))(__VA_ARGS__)
      |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:303:28: note: expanded from macro '___arrow2'
  303 | #define ___arrow2(a, b) a->b
      |                         ~  ^
vm_tracer.bpf.c:471:52: error: no member named 'mmap' in 'struct mm_struct'
  471 |     struct vm_area_struct *vma = BPF_CORE_READ(mm, mmap);
      |                                  ~~~~~~~~~~~~~~~~~~^~~~~
/usr/include/bpf/bpf_core_read.h:444:34: note: expanded from macro 'BPF_CORE_READ'
  444 |         BPF_CORE_READ_INTO(&__r, (src), a, ##__VA_ARGS__);                  \
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:352:20: note: expanded from macro 'BPF_CORE_READ_INTO'
  351 |         ___core_read(bpf_core_read, bpf_core_read,                          \
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  352 |                      dst, (src), a, ##__VA_ARGS__)                          \
      |                      ~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:343:18: note: expanded from macro '___core_read'
  342 |         ___apply(___core_read, ___empty(__VA_ARGS__))(fn, fn_ptr, dst,      \
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  343 |                                                       src, a, ##__VA_ARGS__)
      |                                                       ~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:336:38: note: expanded from macro '___core_read0'
  336 |         ___read(fn, dst, ___type(src), src, a);
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~
/usr/include/bpf/bpf_core_read.h:317:61: note: expanded from macro '___read'
  317 |         read_fn((void *)(dst), sizeof(*(dst)), &((src_type)(src))->accessor)
      |         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
/usr/include/bpf/bpf_core_read.h:246:79: note: expanded from macro 'bpf_core_read'
  246 |         bpf_probe_read_kernel(dst, sz, (const void *)__builtin_preserve_access_index(src))
      |                                                                                      ^~~
vm_tracer.bpf.c:480:34: error: no member named 'vm_next' in 'struct vm_area_struct'
  480 |         vma = BPF_CORE_READ(vma, vm_next);
      |               ~~~~~~~~~~~~~~~~~~~^~~~~~~~
/usr/include/bpf/bpf_core_read.h:443:17: note: expanded from macro 'BPF_CORE_READ'
  443 |         ___type((src), a, ##__VA_ARGS__) __r;                               \
      |         ~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:314:38: note: expanded from macro '___type'
  314 | #define ___type(...) typeof(___arrow(__VA_ARGS__))
      |                             ~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:312:64: note: expanded from macro '___arrow'
  312 | #define ___arrow(...) ___apply(___arrow, ___narg(__VA_ARGS__))(__VA_ARGS__)
      |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
/usr/include/bpf/bpf_core_read.h:303:28: note: expanded from macro '___arrow2'
  303 | #define ___arrow2(a, b) a->b
      |                         ~  ^
9 errors generated.
make: *** [Makefile:67: vm_tracer.bpf.o] Error 1
